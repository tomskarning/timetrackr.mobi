function SegmentationObject(){this.Key;this.Value;this.Init=function(e,i){this.Key=e;this.Value=i}}function CountlyEvent(){this.Key;this.Count;this.UsingSum;this.Sum;this.UsingSegmentation;this.Segmentation=[]}CountlyEvent.prototype.Init=function(e,i,t,n,s,o){};function DeviceInformation(){this.UDID=7;this.OS;this.OSVersion;this.Device;this.Resolution;this.Carrier=null;this.Locale;this.ScreenWidth=screen.width;this.ScreenHeight=screen.height}DeviceInformation.prototype.DetectDevice=function(){var e=navigator.userAgent;if(window.devicePixelRatio>1){this.ScreenWidth*=window.devicePixelRatio;this.ScreenHeight*=window.devicePixelRatio}this.Resolution=this.ScreenWidth>this.ScreenHeight?"{0}x{1}".format(this.ScreenWidth,this.ScreenHeight):"{0}x{1}".format(this.ScreenHeight,this.ScreenWidth);this.Locale=window.navigator.userLanguage||window.navigator.language;if(/iPhone|iPad|iPod/i.test(e)){this.OS="iOS";this.OSVersion=/(i[PSa-z\s]+);.*?CPU\s([OSPa-z\s]+(?:([\d_]+)|;))/i.exec(e).lenght>3?e.match(/(i[PSa-z\s]+);.*?CPU\s([OSPa-z\s]+(?:([\d_]+)|;))/i)[3].replaceAll("_","."):"Unknown";if(/iPhone/i.test(e)){switch(this.Resolution){case"1136x640":this.Device="iPhone 5";break;case"480x320":this.Device="iPhone 3G/S";break;case"960x640":this.Device="iPhone 4G/S";break;default:this.Device="iPhone";break}}else if(/iPad/i.test(e)){switch(window.devicePixelRatio){case 1:this.Device="iPad 1/2";break;case 2:this.Device="iPad 3";break;default:this.Device="iPad";break}}else if(/iPod/i.test(e))this.Device="iPod"}else if(/Android/i.test(e)){this.Device="Android";this.OS="Android OS";this.OSVersion=/Android\s+([\d\.]+)/.test(e)?e.match(/Android\s+([\d\.]+)/)[1]:"Unknown"}else if(/blackberry|BB10|rim tablet os/i.test(e)){this.Device="Blackberry";this.OS="BlackBerry OS";this.OSVersion="Unknown"}else if(/Symbian|SymbOS|Series60|Series40|SYB-[0-9]+|\bS60\b/i.test(e)){this.Device="Symbian";this.OS="Symbian OS";this.OSVersion="Unknown"}else if(/Windows CE.*(PPC|Smartphone|Mobile|[0-9]{3}x[0-9]{3})|Window Mobile|Windows Phone [0-9.]+|WCE;/i.test(e)){this.Device="Windows Mobile";this.OS="Windows Mobile OS";this.OSVersion="Unknown"}else if(/Windows Phone OS|XBLWP7|ZuneWP7/i.test(e)){this.Device="Windows Phone";this.OS="Windows Phone OS";this.OSVersion=/Windows Phone OS\s+([\d\.]+)/.test(e)?e.match(/Windows Phone OS\s+([\d\.]+)/)[1]:"Unknown"}else if(/PalmOS|avantgo|blazer|elaine|hiptop|palm|plucker|xiino/i.test(e)){this.Device="Palm";this.OS="Palm OS";this.OSVersion="Unknown"}else if(/Windows/i.test(e)){this.Device="PC";this.OS="Windows";if(/Windows NT\s+([\d\.]+)/.test(e)){switch(/Windows NT\s+([\d\.]+)/.exec(e)[1]){case"5.1":this.OSVersion="XP";break;case"6.0":this.OSVersion="Vista";break;case"6.1":this.OSVersion="7";break;case"6.2":this.OSVersion="8";break;default:this.OSVersion="Unknown";break}}else this.OSVersion="Unknown"}else if(/Mac/i.test(e)){this.Device="Mac";this.OS="Mac OS X";if(/Mac OS X\s+([\w._]+)/.test(e)){switch(/Mac OS X\s+([\w._]+)/.exec(e)[1]){case"10_4":this.OSVersion="Tiger";break;case"10_5":this.OSVersion="Leopard";break;case"10_6":this.OSVersion="Snow Leopard";break;case"10_7":this.OSVersion="Mountain Lion";break;case"10_8":this.OSVersion="Mountain Lion 8";break;default:this.OSVersion="Unknown";break}}else this.OSVersion="Unknown"}else if(/X11/i.test(e)){this.Device="PC";this.OS="Unix";this.OSVersion="Unknown"}else if(/Linux/i.test(e)){this.Device="PC";this.OS="Linux";this.OSVersion="Unknown"}Countly.Log("OS:{0}, OS Version:{1}, Device:{2}, UDID:{6} Resolution:{3}, Carrier:{4}, Locale:{5}".format(this.OS,this.OSVersion,this.Device,this.Resolution,this.Carrier,this.Locale,this.UDID))};DeviceInformation.prototype.GetMetrics=function(e){var i="{";i+='"'+"_device"+'"'+":"+'"'+this.Device+'"';i+=","+'"'+"_os"+'"'+":"+'"'+this.OS+'"';i+=","+'"'+"_os_version"+'"'+":"+'"'+this.OSVersion+'"';i+=","+'"'+"_carrier"+'"'+":"+'"'+this.Carrier+'"';i+=","+'"'+"_resolution"+'"'+":"+'"'+this.Resolution+'"';i+=","+'"'+"_local"+'"'+":"+'"'+this.Locale+'"';i+=","+'"'+"_app_version"+'"'+":"+'"'+e+'"';i+="}";Countly.Log(i);return i};function Sleep(e){var i=new Date;i.setTime(i.getTime()+e);while((new Date).getTime()<i.getTime());}if(!String.prototype.format){String.prototype.format=function(){var e=arguments;return this.replace(/{(\d+)}/g,function(i,t){return typeof e[t]!="undefined"?e[t]:i})}}String.prototype.replaceAll=function(e,i){return this.replace(new RegExp(e,"g"),i)};var Countly=new function(){this.ServerURL="https://cloud.count.ly";this.AppKey="";this.AppVersion="1.01";this.DataCheckPeriod=10;this.KeepAliveSendPeriod=30;this.IsDebugModeOn=true;this.ConnectionQueue=[];this.IsCountlyWorking;this.PackageSizeForEvents=5;this._eventQueue=[];this.Duration;this.CanSendDataToServer;this.DeviceInfo;this.Log=function(e){if(this.IsDebugModeOn){console.log("Countly -> {0}".format(e))}};this.SendDataToServer=function(){var e;if(this.CanSendDataToServer){while(this.ConnectionQueue.length>0){e=this.ConnectionQueue.pop();this.Send(e)}setTimeout(function(){Countly.SendDataToServer()},Countly.DataCheckPeriod*1e3)}};this.Send=function(e,i){this.Log("call -> {0}".format(e));if(typeof jQuery==="undefined"){function t(e,i,t){var n=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");n.onreadystatechange=function(){if(n.readyState==4&&n.status==200){i(n.responseText);console.log("Data send successfully.")}else{console.log("error");Countly.ConnectionQueue.push(t)}};n.open("POST",e,true);n.send()}t("{0}/i?{1}".format(this.ServerURL,e),true,e)}else{$.ajax({type:"POST",url:"{0}/i?{1}".format(this.ServerURL,e),contentType:"application/json; charset=utf-8",dataType:"json",success:function(e){Countly.Log("Data send successfully.")},error:function(i){Countly.ConnectionQueue.push(e)}})}};this.SeriliazeEvents=function(e){var i="";var t=true;i+="[";for(var n in e){if(t){t=false}else{i+=","}Countly.Log("Event:  "+e[n].Key);i+="{";i+='"'+"key"+'"'+":"+'"'+e[n].Key+'"'+",";i+='"'+"count"+'"'+":"+e[n].Count;if(e[n].UsingSum){i+=",";i+='"'+"sum"+'"'+":"+e[n].Sum}if(e[n].UsingSegmentation){i+=",";i+='"'+"segmentation"+'"'+":"+"{";first2=true;for(var s in e[n].Segmentation){if(first2){first2=false}else{i+=","}i+='"'+e[n].Segmentation[s].Key+'"'+":"+'"'+e[n].Segmentation[s].Value+'"'}i+="}"}i+="}"}i+="]";Countly.Log(i);return i};this.Init=function(e,i,t){this.ServerURL=e;this.AppKey=i;this.AppVersion=t;this.DeviceInfo=new DeviceInformation;this.DeviceInfo.DetectDevice()};this.Init=function(e,i,t,n){this.ServerURL=e;this.AppKey=i;this.AppVersion=t;this.DeviceInfo=new DeviceInformation;this.DeviceInfo.DetectDevice();this.DeviceInfo.UDID=n};this.OnStart=function(){if(this.IsCountlyWorking)return;this.Log("Starting...");if(this.ServerURL==""||this.AppKey==""||this.AppVersion==""){this.Log("Please fill ServerURL, AppKey and AppVersion values with Init() method.");return}this.BeginSession();this.IsCountlyWorking=true;setTimeout(function(){Countly.KeepAlive()},Countly.KeepAliveSendPeriod*1e3);this.CanSendDataToServer=true;this.Duration=0;this.UpdateDuration();this.SendDataToServer();var e=null;e=window.localStorage.getItem("countly");if(e){e=JSON.parse(e);if(e.countly){for(var i=0,t=e.countly.length;i<t;i++)this.ConnectionQueue.push(e.countly[i])}}};this.OnStop=function(){if(!this.IsCountlyWorking)return;var e={};e.countly=this.ConnectionQueue;window.localStorage.setItem("countly",JSON.stringify(e));this.Log("Stopping...");this.IsCountlyWorking=false;this.EndSession()};this.PostEvent=function(e){if(e==null){return}this.Log("Event Queued -> "+e.Key+" : "+e.Count);this._eventQueue.push(e);if(this._eventQueue.length>=this.PackageSizeForEvents){this.QueueEvents();this._eventQueue=[]}};this.KeepAlive=function(){if(!this.IsCountlyWorking)return;this.Log("Keeping Alive...");this.UpdateSession();setTimeout(function(){Countly.KeepAlive()},Countly.KeepAliveSendPeriod*1e3)};this.UpdateDuration=function(){if(this.IsCountlyWorking){this.Duration++;setTimeout(function(){Countly.UpdateDuration()},1e3)}};this.BeginSession=function(){var e="app_key={0}&device_id={1}&sdk_version=1.0&begin_session=1&metrics={2}".format(this.AppKey,this.DeviceInfo.UDID,encodeURIComponent(this.DeviceInfo.GetMetrics(this.AppVersion)));this.Log("Begin Session");this.ConnectionQueue.push(e)};this.UpdateSession=function(){var e="app_key={0}&device_id={1}&session_duration={2}".format(this.AppKey,this.DeviceInfo.UDID,this.Duration);if(this._eventQueue.length>0){var i=this.SeriliazeEvents(this._eventQueue);this._eventQueue=[];e+="&events="+encodeURIComponent(i)}this.Duration=0;this.Log("Update Session");this.ConnectionQueue.push(e)};this.EndSession=function(){var e="app_key={0}&device_id={1}&end_session=1&session_duration={2}".format(this.AppKey,this.DeviceInfo.UDID,this.Duration);if(this._eventQueue.length>0){var i=this.SeriliazeEvents(this._eventQueue);this._eventQueue=[];e+="&events="+encodeURIComponent(i)}this.Log("End Session");this.Send(e,function(){this.CanSendDataToServer=false;this.ConnectionQueue=[];this.Duration=0})};this.QueueEvents=function(){var e="app_key={0}&device_id={1}&events={2}".format(this.AppKey,this.DeviceInfo.UDID,encodeURIComponent(this.SeriliazeEvents(this._eventQueue)));this.Log("Events are packaged. Package is sending...");this.ConnectionQueue.push(e)}};